var jqTableObject=$({});$.sub=function(){jqTableObject.on.apply(jqTableObject,arguments)};$.unsub=function(){jqTableObject.off.apply(jqTableObject,arguments)};$.pub=function(){jqTableObject.trigger.apply(jqTableObject,arguments)};$(function(){var a=["fa-plus-square-o","fa-minus-square-o"];var c=$("body");c.on("click",".g-toggleTable--button",function(d){var i=$(this).parents(".g-toggleTable--title");var f=i.parents(".g-toggleTable--main");var j=f.find(".g-toggleTable--title");var g=f.find("tr");var e=g.index(i);var k=g.length;var h=j.eq(j.index(i)+1);var l=f.data("level");l?e=e+1:false;if(h.length){k=g.index(h)}$.each(f.find("tr"),function(m,n){if(m>e&&m<k){$(n).toggleClass("hide")}});i.find("i.fa").toggleClass(a.join(" "));b(f)});function b(i){var g=i.find(".g-toggleTable--title");var e=i.find(".g-toggleTable--buttonAll");var d=i.find(".g-toggleTable--button."+a[0]).length;var f=i.find(".g-toggleTable--button."+a[1]).length;var h=g.length-1;if(f===h){e.removeClass(a.join(" ")).addClass(a[1])}if(d===h){e.removeClass(a.join(" ")).addClass(a[0])}}c.on("click",".g-toggleTable--buttonAll",function(){var g=$(this);var d=g.hasClass(a[0]);var f=g.parents(".g-toggleTable--main").find(".c-table__child");var e=g.parents(".g-toggleTable--main").find(".g-toggleTable--title .g-toggleTable--button");e.removeClass(a.join(" "));g.removeClass(a.join(" "));if(d){f.removeClass("hide");e.addClass(a[1]);g.addClass(a[1])}else{f.addClass("hide");e.addClass(a[0]);g.addClass(a[0])}})});$(function(){var b=$("body");b.on("change",".g-selectAll",function(c){$(this).parents(".g-selectAll--main").find(".g-selectAll--input").prop("checked",this.checked)});b.on("change",".g-selectAll--input",function(f){var c=$(this).parents(".g-selectAll--main");var e=c.find(".g-selectAll--input").not(".g-selectAll").length;var d=c.find(".g-selectAll--input:checked").not(".g-selectAll").length;if(d===e){c.find(".g-selectAll").prop("checked",true);return}c.find(".g-selectAll").prop("checked",false)});b.on("click",".g-selectAll--btn",function(c){c.preventDefault();a($(this))});function a(c){var g=c.data("destory");var d=c.parents(".g-selectAll--main");var e=d.find(".g-selectAll--input:checked").not(".g-selectAll");var h=[];var j=c.data("text")||"请先选择";var k=c.data("tag")||"";var f={};var i=[];if(!g&&!e.length){$.message({type:"error",message:j,});return false}$.each(e,function(l,m){h.push($(m).data("value"));i.push($(m).val())});f={ele:c,checked:e,checkedArr:h,value:i};$.pub("GSelectAllSuccess"+k,[f])}});$(function(){var H={fixedLeft:false,fixedRight:false,fixedMinWidth:100,totalString:"--",totalTitle:"总计"};var b=r();var N='<div class="hidden-columns"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';var o='<div class="c-table__sort {{class}}"><i class="fa fa-long-arrow-down c-table__down" aria-hidden="true"></i><i class="fa fa-long-arrow-up c-table__up" aria-hidden="true"></i></div >';var m='<div class="c-table__fixed-header-wrapper">{{theadHtml}}</div><div class="c-table__fixed-body-wrapper"> {{tbodyHtml}}</div>';var c='<div class="c-table__fixed"> {{fixedWrapper}}</div>';var q='<div class="c-table__fixed-right"> {{fixedWrapper}}</div>';var u='<div class="c-table--main" style="width: 100%;">{{hideColumn}}<div class="c-table__header-wrapper"> {{theadHtml}}</div><div class="c-table__body-wrapper"> {{tbodyHtml}}</div> {{fixedLeft}}{{fixedRight}}</div>';var y='<td class="gutter"></td>';var w='<td class="gutter" style="width:'+b+'px;"></td>';var t='<div class="c-table__fixed-right-patch" style="width: '+b+'px; height: {{headerHeight}}px;"></div>';$("body").on("click.jqTable",".c-table__down",function(){k($(this),true)});$("body").on("click.jqTable",".c-table__up",function(){k($(this),false)});function F(R,S){this.$container=S;this.config=$.extend({},H,R);this.init(this.$container)}$.extend(F.prototype,{init:function(S){this.render(S);this.event(S);var T=this;var R=this.$table.find(".c-table__sort");if(R){$.each(R,function(U,V){if($(V).hasClass("activeUp")){$(V).find(".c-table__up").trigger("click.jqTable");T.updateEvent();return}if($(V).hasClass("activeDown")){$(V).find(".c-table__down").trigger("click.jqTable");T.updateEvent();return}})}$(window).trigger("resize")},render:function(U){var V=this;var S=x(V,U).data("table",V);if(!V.$table){V.tableHeight=U.data("height");var R=U.parents(".c-table").last();S.addClass(R.attr("class"));R.removeAttr("class");U.after(S).remove();V.$table=S;V.$table.data("height",V.tableHeight)}else{V.$table.html(S.html())}V.colJson=d(V);V.totalJson=Q(V);V.fixedWidth=V.colJson.isAllWidth;V.headerHeight=l(V.$table);if(!V.totalJson.noTotal){V.totalArr=j(V)}if(V.fixedWidth){var T=V.colJson.width.reduce(a,0);V.$table.width(T+1)}B(V)},event:function(R){var S=this;$(window).resize(function(){B(S.$table.data("table"))});this.updateEvent()},updateEvent:function(){var R=this;R.$table.find(".c-table__body-wrapper").scroll(function(){var W=$(this);var T=W.parents(".c-table--main");var Y=W.scrollLeft();var U=W.scrollTop();var X=T.find(".c-table__header-wrapper table");var V=T.find(".c-table__footer-wrapper table");var S=T.find(".c-table__fixed-body-wrapper table");X.css({"margin-left":-Y+"px"});V.css({"margin-left":-Y+"px"});S.css({"margin-top":-U+"px"})});if(R.config.fixedLeft||R.config.fixedRight){R.$table.find("tbody tr").hover(function(){var V=$(this);var U=V.parents(".c-table--main");var T=V.parents("tbody").find("tr").index(V);var S=U.find("tbody");$.each(S,function(X,W){$(W).find("tr").eq(T).addClass("hover-row")})},function(){var S=$(this).parents(".c-table--main").find("tbody");S.find("tr").removeClass("hover-row")})}},updateHtml:function(R){this.init($(R))}});function k(Z,S){var X=S?"activeDown":"activeUp";$(".c-table__sort").removeClass("activeUp activeDown");Z.parents(".c-table__sort").addClass(X);var U=Z.parents(".c-table--main");var W=U.data("table");var ab=U.find(".c-table__fixed-body-wrapper tbody");var R=U.find(".c-table__body-wrapper table tbody");var T=R.find("tr");var aa=Z.parents("thead").find("th");var Y=[];var V=aa.index(Z.parents("th"));$.each(T,function(ae,ad){var ac={};ac.index=ae;ac.value=$(ad).find("td").eq(V).text().trim();Y.push(ac)});Y=z(Y,"value",S);s(W,R,Y);$.each(ab,function(ac,ad){s(W,$(ad),Y)})}function s(Y,S,X){var W=S.find("tr");var T=S.clone();T.html("");for(var V=0,R=X.length;V<R;V++){var U=X[V].index;T.append(W.eq(U).clone())}S.replaceWith(T);Y.updateEvent()}function z(R,T,U){var S;if(R.length<2){return}if(isNaN(R[0][T])){S=A}else{S=p}R.sort(function(W,V){var Y=W[T],X=V[T];if(U){Y=V[T];X=W[T]}return S(Y,X)});return R}function p(S,R){return S-R}function A(S,R){var U=S.toLowerCase(),T=R.toLowerCase();if(U<T){return -1}if(U>T){return 1}return 0}function g(U,W){var aa=e(U,W);if(aa.noSort){return}var Y=aa.sort;var Z=W.find("thead th");for(var S=0,V=Y.length;S<V;S++){var R=Y[S];if(R){var X=R==="up"?"activeUp":R==="down"?"activeDown":"";var T=$(o.replace("{{class}}",X));Z.eq(S).find(".cell").append(T)}}}function l(R){return R.find(".c-table__header-wrapper").height()}function x(X,Z){var T;var Y=Z.clone().addClass("c-table__header");var U=Z.clone().addClass("c-table__body");Y.find("tbody").remove();U.find("thead").remove();g(X,Y);var R=Y[0].outerHTML;var ac=U[0].outerHTML;var W=m.replace("{{theadHtml}}",R).replace("{{tbodyHtml}}",ac);var S=X.config.fixedLeft?c.replace(/{{fixedWrapper}}/g,W):"";var aa=X.config.fixedRight?q.replace(/{{fixedWrapper}}/g,W):"";var ab=u.replace("{{hideColumn}}",N).replace("{{theadHtml}}",R).replace("{{tbodyHtml}}",ac).replace("{{fixedLeft}}",S).replace("{{fixedRight}}",aa);var V=$(ab);return V}function B(Y){var W=Y.$table;var V=W.find(".c-table__header-wrapper");var U=W.find(".c-table__body-wrapper");var Z=V.find("table");var T=U.find("table");var R=W.find("colgroup");var S;var aa=Y.colJson;P(Y,W);S=D(U,T,W,aa);if(!Y.fixedWidth){K(Y,W,aa,S)}var X=W.width();J(W,S);if(Y.fixedWidth){E(Y,W,S)}S=D(U,T,W,aa);if(Y.config.fixedRight||Y.config.fixedLeft){i(Y,W,S);C(Y,W,S)}else{W.addClass("c-table--enable-row-hover el-table--enable-row-transition")}if(S.colScroll&&!W.find(".c-table__fixed-right-patch").length){U.after(t.replace("{{headerHeight}}",Y.headerHeight))}else{if(!S.colScroll){W.find(".c-table__fixed-right-patch").remove()}}if(!Y.totalJson.noTotal){I(Y,W)}}function I(X,S){var W=S.find(".c-table__body-wrapper");var R=W.clone().removeClass("c-table__body-wrapper").addClass("c-table__footer-wrapper");R.find(".c-table__body").removeClass(".c-table__body").addClass("c-table__footer");var V=R.find("tbody tr:not(:first)").remove();var T=S.find(".c-table__footer-wrapper");if(T.length){T.replaceWith(R)}else{W.after(R)}var U=R.find("tbody tr").eq(0).find("td");$.each(U,function(Y,Z){U.find(".cell").eq(Y).html(X.totalArr[Y])})}function j(V){var W=V.totalJson;var U=V.$table.find(".c-table__body-wrapper").find("tbody tr:not(:first)");var Z=[V.config.totalTitle];var R=[];var S=V.config.totalString;$.each(U,function(aa,ab){var ac=$(ab).find("td");$.each(ac,function(ad,ae){if(aa===0){R.push([])}R[ad].push($(ae).text().trim())})});var Y;for(var T=1;T<W.total.length;T++){var X=W.total[T];if(X){Y=R[T].reduce(n,0)}else{Y=S}Z.push(Y)}return Z}function C(aa,Y,R){var V=Y.find(".g-selectAll--input");if(!V.length){return}var W=Y.find(".c-table__fixed");var U=Y.find(".c-table__fixed-right");var X=Y.find(".c-table__body-wrapper tr");var ab,Z=aa.colJson.width.length-1;var S=L(X,0);var T=L(X,Z);if(aa.config.fixedLeft&&S){v(U,X,0)}if(aa.config.fixedRight&&T){v(W,X,Z)}}function v(S,T,R){var U=S.find(".c-table__fixed-body-wrapper tr");if(S.length){$.each(U,function(W,V){h(V,R)})}$.each(T,function(W,V){h(V,R)})}function h(S,R){$(S).find("td").eq(R).find(".g-selectAll--input").remove()}function L(S,R){return S.eq(0).find("td").eq(R).find(".g-selectAll--input").length}function i(ad,aa,S){var V=ad.colJson.width.length;var X=aa.find(".c-table__header-wrapper table th");var ag=aa.find(".c-table__body-wrapper table tr").eq(0);var ab=ag.find("td:not(.gutter)");var Z=ad.headerHeight;var W=aa.height();var ae=W-Z;var Y=aa.find(".c-table__fixed");var U=aa.find(".c-table__fixed-right");if(S.rowScroll){ae-=b}if(ad.config.fixedRight||ad.config.fixedLeft){aa.find(".c-table__fixed-body-wrapper").css({"max-height":ae+"px",top:ad.headerHeight+"px"});Y.find(".c-table__fixed-body-wrapper tr td:not(:first-child):not(.gutter)").addClass("is-hidden");U.find(".c-table__fixed-body-wrapper tr td:not(:nth-child("+V+")):not(.gutter)").addClass("is-hidden")}var ac=S.rowScroll?W-b:W;if(!ad.totalJson.noTotal){ac-=ag.height()}if(ad.config.fixedLeft){var R=ab.eq(0).width();Y.width(R).height(ac);Y.find("table").width(R)}if(ad.config.fixedRight){var af=S.colScroll?b:0;var T=ab.eq(ab.length-1).width();U.width(T).height(ac).css({right:af});U.find("table").width(T)}}function E(X,S,V){var T=S.find(".c-table__header-wrapper table");var R=S.find(".c-table__body-wrapper table");var U=X.colJson.width.reduce(a,0);var W=V.colScroll?U+b:U;S.width(W+1);T.width(U);R.width(U)}function J(S,V){var T=S.find(".c-table__header-wrapper table");var R=S.find(".c-table__body-wrapper table");var U=T.find(".gutter").length;if(V.colScroll&&!U){T.find("colgroup").append(w);T.find("thead tr").append(w);R.find("tbody tr").append(y)}if(!V.colScroll&&U){T.find(".gutter").remove();R.find(".gutter").remove()}}function P(X,S){var T=X.$table.data("height");if(T){var W=S.find(".c-table__body-wrapper");S.css({"max-height":T+"px"});W.css({"max-height":"none"});var V=X.headerHeight;var R=S.height();var U=R-V;if(!X.totalJson.noTotal){U-=W.find("tbody tr").eq(0).height()}W.css({"max-height":U+"px"})}}function K(ab,Z,ad,T){var R=Z.find("colgroup");var ac=Z.width();var V=ad.noWidthIndex.length;var U=ad.tdWidth.reduce(a,0);if(T.colScroll){U+=b}var S=ab.config.fixedMinWidth;var Y=[];for(var X=0;X<V;X++){var ae=ad.noWidthIndex[X];Y.push(ad.tdWidth[ae])}var W=Y.reduce(a,0);var aa=ac-U+W-2;if(Y.length*S>=aa){O(R,ad,Y,S)}else{Y=G(Y,aa,S,Y.length);O(R,ad,Y,false)}U=ad.width.reduce(a,0);Z.find(".c-table__header-wrapper table").width(U);Z.find(".c-table__body-wrapper table").width(U)}function O(T,X,S,W){var V=X.noWidthIndex.length;for(var U=0;U<V;U++){var Y=X.noWidthIndex[U];var R=W||S[U];X.width[Y]=R;$.each(T,function(Z,aa){$(aa).find("col").eq(Y).attr("width",R)})}}function G(Z,T,W,U){var aa=Z.reduce(n,0);var S=(T-aa)/U;var ab=0;var ac=0;var R=0;if(S>0){for(var Y=0;Y<Z.length;Y++){Z[Y]=Z[Y]+S;Z[Y]<W?Z[Y]=W:R++}}else{for(var X=0;X<Z.length;X++){if(Z[X]<W){Z[X]=W}else{if(Z[X]>W){var V=Z[X]+S;if(V>W){R++}Z[X]=V<W?W:V}}}}aa=Z.reduce(n,0);if(Math.floor(aa)!==Math.floor(T)){G(Z,T,W,R)}return Z}function f(T,S){var R=S<T.config.fixedMinWidth?T.config.fixedMinWidth:S;return R}function a(S,R){return S+R}function n(S,R){return S-(-R)}function r(){var T=document.createElement("p");T.style.width="100%";T.style.height="200px";var U=document.createElement("div");U.style.position="absolute";U.style.top="0px";U.style.left="0px";U.style.visibility="hidden";U.style.width="200px";U.style.height="150px";U.style.overflow="hidden";U.appendChild(T);document.body.appendChild(U);var S=T.offsetWidth;U.style.overflow="scroll";var R=T.offsetWidth;if(S==R){R=U.clientWidth}document.body.removeChild(U);return(S-R)}function e(W,T){var U=T.find("colgroup>col");var R=M("sort",U);var S=R.demo;var V=R.nodemo;return{sort:S,noSort:V}}function Q(W){var T=W.$table.find(".c-table__header-wrapper table");var U=T.find("colgroup>col");var R=M("total",U);var V=R.demo;var S=R.nodemo;return{total:V,noTotal:S}}function M(R,U){var V=[];var T=0;U=U.not("[name=gutter]");$.each(U,function(Y,X){var W=$(X).data(R);V.push(W);if(W){T++}});var S=T?false:true;return{demo:V,nodemo:S}}function d(V){V.$table.addClass("c-table--noWrap-init");var Y=V.$table.find(".c-table__header-wrapper table");var U=V.$table.find(".c-table__body-wrapper table");var ab=Y.find("colgroup>col");var aa=Y.width();var T=U.width();var S=[];var W=[];var ad=aa>T?aa:T;var X=[];var Z=[];var ac=true;var R=aa>T?Y.find("tr").eq(0).find("th"):U.find("tr").eq(0).find("td");ab=ab.not("[name=gutter]");$.each(ab,function(ah,af){var ae=$(af).attr("width")?Number($(af).attr("width")):0;S.push(ae);if(ae){Z.push(ae);W.push(ae)}else{var ag=R.eq(ah).find(".cell").width()+1;ac=false;X.push(ah);W.push(ag)}});V.$table.addClass("c-table__cell--block").removeClass("c-table--noWrap-init");return{width:S,noWidthIndex:X,hasWidthArr:Z,isAllWidth:ac,realTotalWidth:ad,tdWidth:W}}function D(X,S,T,V){var W=X.height()<S.height();var R=V.width.reduce(a,0)+1;if(W){R+=b}var U=R>T.width();return{rowScroll:U,colScroll:W}}$.fn.jqTable=function(R){return this.each(function(){new F(R,$(this))})}}());